<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>game</title>
    <script src="./assets/js/pixi.min.js" charset="utf-8"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
        border: none;
      }
    </style>
  </head>
  <body>
    <script>
      // stage宽和高
      var stageHeight = window.innerHeight;
      var stageWidth  = window.innerWidth;
      // 将默认的缩放模式定义为Nearest，这样就不会太模糊
      // PIXI.SCALE_MODES.DEFAULT = PIXI.SCALE_MODES.NEAREST;
      // 通过自动选择的方式创建画布（800x450）
      const app = new PIXI.application();
      // var renderer = PIXI.autoDetectRenderer(stageWidth, stageHeight, {backgroundColor: 0x000000});

      document.body.appendChild(app.view);
      // 创建舞台container
      var stage = new PIXI.Container();
      //创建图片精灵，以便在画面上显示些东西
      // var background = new PIXI.Sprite.fromImage('./assets/img/BackDrop_01.png');
      // background.width = renderer.width;
      // background.height = renderer.height;
      // stage.addChild(background);
      // 创建一个玩家精灵
      var player = new PIXI.Sprite.fromImage('./assets/img/plane.png');
      player.position.set(stageWidth/2, stageHeight - 50);
      // 将中心点固定在角色图片的中心
      player.anchor.set(0.5);
      player.scale.x = 0.5;
      player.scale.y = 0.5;
      stage.addChild(player);

      var contentWidth = 51.2 + 70 * 9;
      var leftWhiteSpcae = (stageWidth - contentWidth) / 2;
      console.log(stageWidth);
      console.log(contentWidth);
      for(var i=0; i<4; i++) {
        for (var j=0; j<10; j++) {
          var enemy = new PIXI.Sprite.fromImage('./assets/img/enemy_2.png');
          enemy.anchor.set(0.5);
          enemy.position.set(leftWhiteSpcae+70*j, 70*i+50);
          enemy.scale.x = 0.4;
          enemy.scale.y = 0.35;
          stage.addChild(enemy);
        }
      }

      animate();
      // 动画
      function animate() {
        requestAnimationFrame(animate);
        // 渲染Container
        renderer.render(stage);
      }

      document.onkeydown = function (e) {
        switch (e.keyCode) {
          case 37:
            move(player, -10);
            break;
          case 38:
            break;
          case 39:
            move(player, 10);
            break;
          case 40:
            break;
          case 32:
            shoot(player, 1);
            break;
        }
      }

      function move (object, distance) {
        object.x = object.x + distance;
        console.log(object.x + ' **** ' + distance);
      }

      function shoot (object, dir) {
        var x = object.x;
        var bullet = new PIXI.Graphics();
        bullet.beginFill(0xFFFF00);
        bullet.lineStyle(1, 0xFFFF00);
        bullet.drawRect(x, stageHeight-100, 2, 8);
        stage.addChild(bullet);
      }


    </script>

  </body>
</html>
